<app-loader />
<p-toast position="top-right" />

<div class="login-page">
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="grid-bg"></div>

  <!-- Theme toggle flotante -->
  <div class="theme-fab">
    <app-theme-toggle />
  </div>

  <div class="login-card">

    <!-- Marca -->
    <div class="brand">
      <div class="brand-icon">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
          <circle cx="16" cy="16" r="16" fill="url(#grad)"/>
          <path d="M8 16 L16 8 L24 16 L16 24 Z" fill="white" opacity="0.9"/>
          <circle cx="16" cy="16" r="4" fill="white"/>
          <defs>
            <linearGradient id="grad" x1="0" y1="0" x2="32" y2="32">
              <stop offset="0%" stop-color="#3b82f6"/>
              <stop offset="100%" stop-color="#8b5cf6"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <div class="brand-text">
        <h1>Solaris Platform</h1>
        <p>Enterprise Resource Planning</p>
      </div>
    </div>

    <div class="login-header">
      <h2>Iniciar Sesión</h2>
      <p>Ingresa tus credenciales para continuar</p>
    </div>

    @if (error()) {
      <p-message severity="error" [text]="error()" styleClass="w-full mb-4" />
    }

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="login-form">

      <div class="field">
        <label for="email">Correo electrónico</label>
        <input
          pInputText
          id="email"
          type="email"
          formControlName="email"
          placeholder="usuario@empresa.com"
          [class.ng-invalid]="emailInvalid"
          autocomplete="email"
        />
        @if (emailInvalid) {
          <small class="error-msg">
            @if (form.get('email')?.hasError('required')) { El email es requerido }
            @else if (form.get('email')?.hasError('email')) { Formato de email inválido }
          </small>
        }
      </div>

      <div class="field">
        <label for="password">Contraseña</label>
        <p-password
          id="password"
          formControlName="password"
          placeholder="••••••••"
          [feedback]="false"
          [toggleMask]="true"
          styleClass="w-full"
          inputStyleClass="w-full"
          autocomplete="current-password"
        />
        @if (passwordInvalid) {
          <small class="error-msg">La contraseña es requerida (mín. 6 caracteres)</small>
        }
      </div>

      <p-button
        type="submit"
        label="Ingresar al sistema"
        icon="pi pi-sign-in"
        [loading]="cargando()"
        [disabled]="cargando()"
        styleClass="w-full login-btn"
      />

    </form>

    <div class="login-footer">
      <span>Solaris Platform v1.0.0</span>
      <span>·</span>
      <span>© 2025 Todos los derechos reservados</span>
    </div>

  </div>
</div>
